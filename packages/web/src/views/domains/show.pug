extends ../base

mixin group_index(data, index)
  if (index%2 === 0)
    section(class="bg-lightGray")
      p= data.id 
      p= data.passed
      block 
  else 
    section(class="")
      p= data.id 
      p= data.passed
      block 

block body
  include ../partials/header.pug
  include ../partials/footer.pug
  +header 
  div(class="max-w-5xl lg:w-full mx-6 md:mx-16 lg:mx-auto mt-2 sm:mt-28 flex-grow flex flex-col")
    h1(class="mb-8")= 'Test historik för ' + domain.domain_name

    section(class="mb-6")
      h2 Senast utfört test
      table(id="customers" class="table-fixed w-full")
          tr(class="text-left")
            th(class="p-2 md:p-3 text-lightPeach bg-black rounded-tl-lg")
              p Skapat
            th(class="p-2 md:p-3 text-lightPeach bg-black w-1/4 md:w-fit") 
              p Status
            th(class="p-2 md:p-3 text-lightPeach bg-black rounded-tr-lg")  
          tr 
            td(class="p-2 md:p-3") 
                p= last_test.created_at
            td(class="p-2 md:p-3") 
                img(src=`/img/${last_test.passed ? 'icon-success.svg' : 'icon-fail.svg'}` class="md:pl-2")
            td(class="p-2 md:p-3 text-left sm:text-right") 
              a(href=`/test/${last_test.id}`) Visa resultat
    section(class="mb-6")
      h2 Historik
      div(class="grid grid-cols-3 bg-black text-peach")     
      if history.length
        table(id="customers" class="table-fixed w-full")
          tr(class="text-left")
            th(class="p-2 md:p-4 text-lightPeach bg-black rounded-tl-lg")
              p Skapat
            th(class="p-2 md:p-3 text-lightPeach bg-black w-1/4 md:w-fit") 
              p Status 
            th(class="p-2 md:p-3 text-lightPeach bg-black rounded-tr-lg") 
          each h in history   
            tr 
              td(class="p-2 md:p-3") 
                  p= h.created_at
              td(class="p-2 md:p-3") 
                img(src=`/img/${h.passed ? 'icon-success.svg' : 'icon-fail.svg'}` class="md:pl-2")
              td(class="p-2 md:p-3 text-left sm:text-right") 
                a(href=`/test/${h.id}`) Visa resultat

  +footer
